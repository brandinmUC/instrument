<body></body>
<script src="https://unpkg.com/tone"></script>
<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://algorithmicmusic.online/js/create-spectrum.js"></script>
<script src="https://algorithmicmusic.online/js/create-waveform.js"></script>
<script>
/* global Tone, nn, d3, createWaveform, createSpectrum */
const sound = "https://upload.wikimedia.org/wikipedia/commons/4/49/En-au-yell_at.ogg"
const player = new Tone.Player(sound)
player.toDestination()

const lfo = new Tone.LFO({
  frequency: 2, // modulation rate in Hz
  min: -100,     // minimum deviation (below 440 Hz)
  max: 100       // maximum deviation (above 440 Hz)
})
  
function changeRate (e) {
  const rate = Number(e.target.value)
  lfo.set({ frequency: rate })
  rateLabel.content(`rate: ${rate.toFixed(2)}`)
}

// UI (to trigger play function)
nn.create('input')
  .set({
    type: 'range',
    min: 220, // minimum value for this slider
    max: 880, // maximum value for this range
    value: 440, // default value
    step: 0.1 // smallest change we can make when we slide it
  })
  .addTo('body')
  .on('input', changeRate)
  

nn.create('button')
  .content('play sound')
  .addTo('body')
  .on('mousedown', () => player.start())


// visualizations
const spec = createSpectrum({ range: [0, 8000] })
player.connect(spec)

</script>