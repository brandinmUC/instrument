<body></body>
<script src="https://unpkg.com/tone"></script>
<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://algorithmicmusic.online/js/create-spectrum.js"></script>
<script src="https://algorithmicmusic.online/js/create-waveform.js"></script>
<script>
/* global Tone, nn, d3, createWaveform, createSpectrum */
const sound = "https://upload.wikimedia.org/wikipedia/commons/4/49/En-au-yell_at.ogg"
const player = new Tone.Player(sound)
player.toDestination()
player.loop = true
  
function changeRate (e) {
  const rate = Number(e.target.value)
  player.playbackRate = rate
}

function togglePlayer(e) {
  if (e.target.checked){
     player.start()
  }
  else {
    player.stop()
  }
}  
  
// UI (to trigger play function)
nn.create('input')
  .set({
    type: 'range',
    min: -1, // minimum value for this slider
    max: 3, // maximum value for this range
    value: 1, // default value
    step: 0.01 // smallest change we can make when we slide it
  })
  .addTo('body')
  .on('input', changeRate)
  

nn.create('input')
  .set({ type: 'checkbox' })
  .content('play sound')
  .addTo('body')
  .on('change', togglePlayer)


// visualizations
const spec = createSpectrum({ range: [0, 8000] })
player.connect(spec)

</script>